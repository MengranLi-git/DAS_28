"0","boot_models <- bootstraps(Data[, -1], times = 1000, apparent = TRUE) %>%"
"0","  mutate("
"0","    model = map(splits, ~ lm(Satisfaction ~ DateCode + Cards + Repair + Work_Bus + "
"0","                               School + Health + Work_Train + Train_Stations + Without_Car + "
"0","                               Petrol_Diesel, data = .)),"
"0","    coef_info = map(model, tidy)"
"0","  )"
"0",""
"0","boot_coefs <- boot_models %>%"
"0","  unnest(coef_info)"
"0",""
"0","ci <- int_pctl(boot_models, coef_info)"
"0","# significant at 0.05"
"0","sig <- ci[sign(ci[, 2]) == sign(ci[, 4]), ] %>% pull(term)"
"0",""
"0","boot_coefs <-  boot_coefs %>%"
"0","  mutate(sig = ifelse(term %in% sig, ""TRUE"", ""FALSE"")) %>%"
"0","  filter(term %in% c(""Cards"", ""Health"", ""Petrol_Diesel"",""Repair"", ""School"", ""Train_Stations"", ""Without_Car"", ""Work_Bus"", ""Work_Train""))"
"0",""
"0","boot_coefs2 <- boot_coefs %>%"
"0","  group_by(term) %>%"
"0","  summarise(est = median(estimate), lower = quantile(estimate, 0.025), upper = quantile(estimate, 0.975))"
"0",""
"0","boot_coefs %>%"
"0","  ggplot() +"
"0","  geom_density(aes(estimate, fill = sig), alpha = 0.7,  color = ""white"") +"
"0","  geom_vline(data = boot_coefs2, mapping = aes(xintercept = est))+"
"0","  geom_vline(data = boot_coefs2, mapping = aes(xintercept = lower), color=""Red"", lty = 2)+"
"0","  geom_vline(data = boot_coefs2, mapping = aes(xintercept = upper), color=""Red"", lty = 2)+"
"0","  geom_vline(data = boot_coefs2, mapping = aes(xintercept = 0), color=""Blue"", lty = 2)+"
"0","  facet_wrap(~term, scales = ""free"")+"
"0","  theme(axis.text.x= element_text(size = 6),"
"0","        axis.text.y= element_text(size = 6))"
