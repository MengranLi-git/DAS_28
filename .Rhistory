Petrol_Diesel, data = .)),
coef_info = map(model, tidy)
)
boot_coefs <- boot_models %>%
unnest(coef_info)
ci <- int_pctl(boot_models, coef_info)
# significant at 0.05
ci[sign(ci[, 2]) == sign(ci[, 4]), c(1, 3)]
boot_coefs %>%
filter(term == "Cards")
boot_coefs %>%
group_by() %>%
ggplot(aes(estimate)) +
geom_histogram(alpha = 0.7, fill = "#80C687")
boot_coefs %>%
group_by() %>%
ggplot(aes(estimate)) +
geom_histogram(alpha = 0.7, fill = "#80C687") +
facet(~term)
boot_coefs %>%
group_by() %>%
ggplot(aes(estimate)) +
geom_histogram(alpha = 0.7, fill = "#80C687") +
facet_wrap(~term)
boot_coefs %>%
group_by() %>%
ggplot(aes(estimate)) +
geom_histogram(alpha = 0.7, fill = "#80C687") +
facet_wrap(~term, scales = "free")
boot_coefs %>%
ggplot(aes(estimate)) +
geom_histogram(alpha = 0.7, fill = "#80C687") +
facet_wrap(~term, scales = "free")
boot_coefs %>%
filter(term == "Petrol_Diesel")
boot_coefs %>%
ggplot(aes(estimate)) +
geom_histogram(alpha = 0.7, fill = "#80C687") +
geom_abline(aes(median(estimate))) %>%
facet_wrap(~term, scales = "free")
boot_coefs %>%
ggplot(aes(estimate)) +
geom_histogram(alpha = 0.7, fill = "#80C687") +
geom_vline(xintercept = median(estimate)) %>%
facet_wrap(~term, scales = "free")
boot_coefs %>%
ggplot() +
geom_histogram(aes(estimate), alpha = 0.7, fill = "#80C687") +
geom_vline(xintercept = median(estimate)) %>%
facet_wrap(~term, scales = "free")
boot_coefs %>%
ggplot() +
geom_histogram(aes(estimate), alpha = 0.7, fill = "#80C687")
boot_coefs %>%
ggplot() +
geom_histogram(aes(estimate), alpha = 0.7, fill = "#80C687") +
geom_vline(xintercept = median(estimate))
boot_coefs %>%
group_by(term) %>%
mutate(est = median(estimate)) %>%
ggplot() +
geom_histogram(aes(estimate), alpha = 0.7, fill = "#80C687") +
geom_vline(xintercept = median(est)) %>%
facet_wrap(~term, scales = "free")
boot_coefs %>%
group_by(term)
boot_coefs %>%
group_by(term) %>%
mutate(est = median(estimate))
boot_coefs %>%
group_by(term) %>%
mutate(est = median(estimate)) %>%
ggplot() +
geom_histogram(aes(estimate), alpha = 0.7, fill = "#80C687")
boot_coefs %>%
group_by(term) %>%
mutate(est = median(estimate)) %>%
ggplot() +
geom_histogram(aes(estimate), alpha = 0.7, fill = "#80C687") +
geom_vline(xintercept = median(est))
boot_coefs %>%
group_by(term) %>%
mutate(est = median(estimate)) %>%
ggplot() +
geom_histogram(aes(estimate), alpha = 0.7, fill = "#80C687") +
geom_vline(xintercept = median(.$est)) %>%
facet_wrap(~term, scales = "free")
boot_coefs %>%
ggplot() +
geom_histogram(aes(estimate), alpha = 0.7, fill = "#80C687") +
geom_vline(xintercept = median(boot_coefs %>%
group_by(term) %>%
mutate(est = median(estimate)))) %>%
facet_wrap(~term, scales = "free")
boot_coefs %>%
ggplot() +
geom_histogram(aes(estimate), alpha = 0.7, fill = "#80C687") +
geom_vline(xintercept = 3) %>%
facet_wrap(~term, scales = "free")
boot_coefs %>%
ggplot() +
geom_histogram(aes(estimate), alpha = 0.7, fill = "#80C687") +
#  geom_vline(xintercept = 3) %>%
facet_wrap(~term, scales = "free")
boot_coefs %>%
ggplot() +
geom_histogram(aes(estimate), alpha = 0.7, fill = "#80C687") +
geom_vline(xintercept = 0) %>%
facet_wrap(~term, scales = "free")
boot_coefs %>%
ggplot() +
geom_histogram(aes(estimate), alpha = 0.7, fill = "#80C687") +
geom_vline(xintercept = 0)
boot_coefs %>%
ggplot() +
geom_histogram(aes(estimate), alpha = 0.7, fill = "#80C687") +
geom_vline(data = ddply(boot_coefs , "panel", summarize, est = median(estimate)), aes(xintercept=est)) %>%
facet_wrap(~term, scales = "free")
boot_coefs %>%
ggplot() +
geom_histogram(aes(estimate), alpha = 0.7, fill = "#80C687") +
geom_vline(data = ddply(boot_coefs , "panel", summarize, est = median(estimate)), aes(xintercept=est))
boot_coefs %>%
group_by(estimate) %>%
summarise(est = mean(estimate))
boot_coefs %>%
group_by(estimate) %>%
summarise(est = median(estimate))
boot_coefs
boot_coefs %>%
group_by(term) %>%
summarise(est = median(estimate))
boot_coefs %>%
ggplot() +
geom_histogram(aes(estimate), alpha = 0.7, fill = "#80C687") +
geom_vline(data = ddply(boot_coefs , "panel", summarize, est = median(estimate)), aes(xintercept=est)) +
facet_wrap(~term, scales = "free")
boot_coefs %>%
ggplot() +
geom_histogram(aes(estimate), alpha = 0.7, fill = "#80C687") +
geom_vline(data = boot_coefs2, mapping = aes(xintercept = est))+
facet_wrap(~term, scales = "free")
boot_coefs2 <- boot_coefs %>%
group_by(term) %>%
summarise(est = median(estimate))
boot_coefs %>%
ggplot() +
geom_histogram(aes(estimate), alpha = 0.7, fill = "#80C687") +
geom_vline(data = boot_coefs2, mapping = aes(xintercept = est))+
facet_wrap(~term, scales = "free")
boot_coefs2 <- boot_coefs %>%
group_by(term) %>%
summarise(est = median(estimate), lower = quantile(estimate, 0.025), upper = quantile(estimate, 0.975))
boot_coefs %>%
ggplot() +
geom_histogram(aes(estimate), alpha = 0.7, fill = "#80C687") +
geom_vline(data = boot_coefs2, mapping = aes(xintercept = c(est, lower, upper)))+
facet_wrap(~term, scales = "free")
boot_coefs2 <- boot_coefs %>%
group_by(term) %>%
summarise(est = median(estimate), lower = quantile(estimate, 0.025), upper = quantile(estimate, 0.975))
boot_coefs2
boot_coefs %>%
ggplot() +
geom_histogram(aes(estimate), alpha = 0.7, fill = "#80C687") +
geom_vline(data = boot_coefs2, mapping = aes(xintercept = est))+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = lower))+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = upper))+
facet_wrap(~term, scales = "free")
boot_coefs %>%
ggplot() +
geom_density(aes(estimate), alpha = 0.7, fill = "#80C687") +
geom_vline(data = boot_coefs2, mapping = aes(xintercept = est))+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = lower))+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = upper))+
facet_wrap(~term, scales = "free")
boot_coefs %>%
ggplot() +
geom_histogram(aes(estimate), alpha = 0.7, fill = "#80C687") +
geom_vline(data = boot_coefs2, mapping = aes(xintercept = est))+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = lower))+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = upper))+
facet_wrap(~term, scales = "free")
boot_coefs %>%
ggplot() +
geom_histogram(aes(estimate), alpha = 0.7, fill = "#80C687") +
geom_vline(data = boot_coefs2, mapping = aes(xintercept = est))+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = lower, color="Red"))+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = upper))+
facet_wrap(~term, scales = "free")
boot_coefs %>%
ggplot() +
geom_histogram(aes(estimate), alpha = 0.7, fill = "#80C687") +
geom_vline(data = boot_coefs2, mapping = aes(xintercept = est))+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = lower, color="Red"))+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = upper, color="Red"))+
facet_wrap(~term, scales = "free")
boot_coefs %>%
ggplot() +
geom_histogram(aes(estimate), alpha = 0.7, fill = "#80C687") +
geom_vline(data = boot_coefs2, mapping = aes(xintercept = est))+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = lower), color="Red")+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = upper), color="Red")+
facet_wrap(~term, scales = "free")
boot_coefs %>%
ggplot() +
geom_histogram(aes(estimate), alpha = 0.7, fill = "#80C687") +
geom_vline(data = boot_coefs2, mapping = aes(xintercept = est))+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = lower), color="Red", lty = 2)+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = upper), color="Red")+
facet_wrap(~term, scales = "free")
boot_coefs %>%
ggplot() +
geom_histogram(aes(estimate), alpha = 0.7, fill = "#80C687") +
geom_vline(data = boot_coefs2, mapping = aes(xintercept = est))+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = lower), color="Red", lty = 2)+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = upper), color="Red", lty = 2)+
facet_wrap(~term, scales = "free")
boot_coefs %>%
ggplot() +
geom_histogram(aes(estimate), alpha = 0.7, fill = "#80C687") +
geom_vline(data = boot_coefs2, mapping = aes(xintercept = est))+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = lower), color="Red", lty = 2)+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = upper), color="Red", lty = 2)+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = 0), color="Blue")+
facet_wrap(~term, scales = "free")
boot_coefs %>%
ggplot() +
geom_histogram(aes(estimate), alpha = 0.7, fill = "#80C687") +
geom_vline(data = boot_coefs2, mapping = aes(xintercept = est))+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = lower), color="Red", lty = 2)+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = upper), color="Red", lty = 2)+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = 0), color="Blue", lty = 2)+
facet_wrap(~term, scales = "free")
boot_coefs %>%
ggplot() +
geom_density(aes(estimate), alpha = 0.7, fill = "#80C687", color = NULL) +
geom_vline(data = boot_coefs2, mapping = aes(xintercept = est))+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = lower), color="Red", lty = 2)+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = upper), color="Red", lty = 2)+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = 0), color="Blue", lty = 2)+
facet_wrap(~term, scales = "free")
boot_coefs %>%
ggplot() +
geom_density(aes(estimate), alpha = 0.7, fill = "#80C687", color = "white") +
geom_vline(data = boot_coefs2, mapping = aes(xintercept = est))+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = lower), color="Red", lty = 2)+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = upper), color="Red", lty = 2)+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = 0), color="Blue", lty = 2)+
facet_wrap(~term, scales = "free")
ci[sign(ci[, 2]) == sign(ci[, 4]), c(1, 3)]
boot_coefs %>%
mutate(sig = )
ggplot() +
geom_density(aes(estimate), alpha = 0.7, fill = "#80C687", color = "white") +
geom_vline(data = ci, mapping = aes(xintercept = .estimate))+
geom_vline(data = ci, mapping = aes(xintercept = .lower), color="Red", lty = 2)+
geom_vline(data = ci, mapping = aes(xintercept = .upper), color="Red", lty = 2)+
geom_vline(data = ci, mapping = aes(xintercept = 0), color="Blue", lty = 2)+
facet_wrap(~term, scales = "free")
ci
names(ci) %>% remove(".")
names(ci) %>% str_remove(".")
names(ci) = names(ci) %>% str_remove(".")
boot_coefs %>%
mutate(sig = )
ggplot() +
geom_density(aes(estimate), alpha = 0.7, fill = "#80C687", color = "white") +
geom_vline(data = ci, mapping = aes(xintercept = estimate))+
geom_vline(data = ci, mapping = aes(xintercept = lower), color="Red", lty = 2)+
geom_vline(data = ci, mapping = aes(xintercept = upper), color="Red", lty = 2)+
geom_vline(data = ci, mapping = aes(xintercept = 0), color="Blue", lty = 2)+
facet_wrap(~term, scales = "free")
# significant at 0.05
ci[sign(ci[, 2]) == sign(ci[, 4]), c(1, 3)]
# significant at 0.05
ci[sign(ci[, 2]) == sign(ci[, 4]), "sig"] = "TRUE"
ci <- int_pctl(boot_models, coef_info)
ci
# significant at 0.05
ci[sign(ci[, 2]) == sign(ci[, 4]), "term"]
# significant at 0.05
sig <- ci[sign(ci[, 2]) == sign(ci[, 4]), "term"]
boot_coefs %>%
group_by(term) %>%
summarise(est = median(estimate), lower = quantile(estimate, 0.025), upper = quantile(estimate, 0.975))
mutate(sig = estimate %in% sig)
boot_coefs %>%
group_by(term) %>%
summarise(est = median(estimate), lower = quantile(estimate, 0.025), upper = quantile(estimate, 0.975))
mutate(sig = term %in% sig)
boot_coefs %>%
group_by(term) %>%
summarise(est = median(estimate), lower = quantile(estimate, 0.025), upper = quantile(estimate, 0.975))
mutate(sig = .$term %in% sig)
boot_coefs %>%
group_by(term) %>%
summarise(est = median(estimate), lower = quantile(estimate, 0.025), upper = quantile(estimate, 0.975))
mutate(sig = boot_coefs2$term %in% sig)
boot_coefs2$term %in% sig
boot_coefs %>%
group_by(term) %>%
summarise(est = median(estimate), lower = quantile(estimate, 0.025), upper = quantile(estimate, 0.975))
mutate(sig = as.character(boot_coefs2$term %in% sig))
as.character(boot_coefs2$term %in% sig)
boot_coefs %>%
group_by(term) %>%
summarise(est = median(estimate), lower = quantile(estimate, 0.025), upper = quantile(estimate, 0.975))%>%
mutate(sig = as.character(boot_coefs2$term %in% sig))
boot_coefs2 <- boot_coefs %>%
group_by(term) %>%
summarise(est = median(estimate), lower = quantile(estimate, 0.025), upper = quantile(estimate, 0.975))%>%
mutate(sig = as.character(boot_coefs2$term %in% sig))
boot_coefs %>%
mutate(sig = as.character(boot_coefs$term %in% sig)) %>%
ggplot() +
geom_density(aes(estimate, fill = sig), alpha = 0.7, color = "white") +
geom_vline(data = boot_coefs2, mapping = aes(xintercept = est))+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = lower), color="Red", lty = 2)+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = upper), color="Red", lty = 2)+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = 0), color="Blue", lty = 2)+
facet_wrap(~term, scales = "free")
sig
boot_coefs %>%
mutate(sign = as.character(boot_coefs$term %in% sig)) %>%
ggplot() +
geom_density(aes(estimate, fill = sign), alpha = 0.7, color = "white") +
geom_vline(data = boot_coefs2, mapping = aes(xintercept = est))+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = lower), color="Red", lty = 2)+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = upper), color="Red", lty = 2)+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = 0), color="Blue", lty = 2)+
facet_wrap(~term, scales = "free")
boot_coefs %>%
mutate(sign = as.character(boot_coefs$term %in% sig))
# significant at 0.05
sig <- ci[sign(ci[, 2]) == sign(ci[, 4]), "term"]
sig
boot_coefs %>%
mutate(sign = boot_coefs$term %in% sig)
boot_coefs %>%
mutate(sign = boot_coefs$term %in% sig) %>%
ggplot() +
geom_density(aes(estimate, fill = sign), alpha = 0.7, color = "white") +
geom_vline(data = boot_coefs2, mapping = aes(xintercept = est))+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = lower), color="Red", lty = 2)+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = upper), color="Red", lty = 2)+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = 0), color="Blue", lty = 2)+
facet_wrap(~term, scales = "free")
boot_coefs$term
sig
boot_coefs$term %in% sig
is.character(sig)
is.character(sig)
boot_coefs %>%
mutate(sign = boot_coefs$term %in% as.character(sig))
boot_coefs$term %in% as.character(sig)
boot_coefs
sig
boot_coefs$term %in% sig
boot_coefs$term %in% as.character(sig)
boot_coefs$term
as.character(sig)
sig
boot_coefs$term %in% sig$term
boot_coefs %>%
mutate(sig = if_else(term %in% sig$term), "TRUE", "FALSE")
boot_coefs %>%
mutate(sig = if_else(boot_coefs$term %in% sig$term), "TRUE", "FALSE")
boot_coefs %>%
mutate(sig = ifelse(boot_coefs$term %in% sig$term), "TRUE", "FALSE")
boot_coefs %>%
mutate(sig = ifelse(term %in% sig$term), "TRUE", "FALSE")
sig$term
boot_coefs %>%
mutate(sig = ifelse(term %in% c(sig$term)), "TRUE", "FALSE")
# significant at 0.05
sig <- ci[sign(ci[, 2]) == sign(ci[, 4]), ] %>% pull(term)
boot_coefs %>%
mutate(sig = ifelse(term %in% sig), "TRUE", "FALSE")
ci[sign(ci[, 2]) == sign(ci[, 4]), ]
boot_coefs %>%
mutate(sig = ifelse(term %in% sig, "TRUE", "FALSE"))
boot_coefs %>%
mutate(sig = ifelse(term %in% sig, "TRUE", "FALSE")) %>%
ggplot() +
geom_density(aes(estimate), alpha = 0.7, fill = c("#80C687","red"), color = "white") +
geom_vline(data = boot_coefs2, mapping = aes(xintercept = est))+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = lower), color="Red", lty = 2)+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = upper), color="Red", lty = 2)+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = 0), color="Blue", lty = 2)+
facet_wrap(~term, scales = "free")
boot_coefs %>%
mutate(sig = ifelse(term %in% sig, "TRUE", "FALSE")) %>%
ggplot() +
geom_density(aes(estimate, fill = c("#80C687","red")), alpha = 0.7,  color = "white") +
geom_vline(data = boot_coefs2, mapping = aes(xintercept = est))+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = lower), color="Red", lty = 2)+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = upper), color="Red", lty = 2)+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = 0), color="Blue", lty = 2)+
facet_wrap(~term, scales = "free")
boot_coefs %>%
mutate(sig = ifelse(term %in% sig, "TRUE", "FALSE")) %>%
ggplot() +
geom_density(aes(estimate, fill = sig), alpha = 0.7,  color = "white") +
geom_vline(data = boot_coefs2, mapping = aes(xintercept = est))+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = lower), color="Red", lty = 2)+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = upper), color="Red", lty = 2)+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = 0), color="Blue", lty = 2)+
facet_wrap(~term, scales = "free")
boot_coefs %>%
mutate(sig = ifelse(term %in% sig, "TRUE", "FALSE")) %>%
select(Health, Petrol_Diesel, Repair, School, Train_Station, Without_Car, Work_Bus, Work_Train) %>% %>%
ggplot() +
geom_density(aes(estimate, fill = sig), alpha = 0.7,  color = "white") +
geom_vline(data = boot_coefs2, mapping = aes(xintercept = est))+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = lower), color="Red", lty = 2)+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = upper), color="Red", lty = 2)+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = 0), color="Blue", lty = 2)+
facet_wrap(~term, scales = "free")
boot_coefs %>%
mutate(sig = ifelse(term %in% sig, "TRUE", "FALSE")) %>%
filter(term %in% c("Health", "Petrol_Diesel","Repair", "School", "Train_Station", "Without_Car", "Work_Bus", "Work_Train")) %>%
ggplot() +
geom_density(aes(estimate, fill = sig), alpha = 0.7,  color = "white") +
geom_vline(data = boot_coefs2, mapping = aes(xintercept = est))+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = lower), color="Red", lty = 2)+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = upper), color="Red", lty = 2)+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = 0), color="Blue", lty = 2)+
facet_wrap(~term, scales = "free")
boot_coefs <-  boot_coefs %>%
mutate(sig = ifelse(term %in% sig, "TRUE", "FALSE")) %>%
filter(term %in% c("Health", "Petrol_Diesel","Repair", "School", "Train_Station", "Without_Car", "Work_Bus", "Work_Train")) %>%
boot_coefs2 <- boot_coefs %>%
group_by(term) %>%
summarise(est = median(estimate), lower = quantile(estimate, 0.025), upper = quantile(estimate, 0.975))
boot_coefs <-  boot_coefs %>%
mutate(sig = ifelse(term %in% sig, "TRUE", "FALSE")) %>%
filter(term %in% c("Health", "Petrol_Diesel","Repair", "School", "Train_Station", "Without_Car", "Work_Bus", "Work_Train"))
boot_coefs2 <- boot_coefs %>%
group_by(term) %>%
summarise(est = median(estimate), lower = quantile(estimate, 0.025), upper = quantile(estimate, 0.975))
boot_coefs <-
ggplot() +
geom_density(aes(estimate, fill = sig), alpha = 0.7,  color = "white") +
geom_vline(data = boot_coefs2, mapping = aes(xintercept = est))+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = lower), color="Red", lty = 2)+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = upper), color="Red", lty = 2)+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = 0), color="Blue", lty = 2)+
facet_wrap(~term, scales = "free")
boot_coefs2
boot_coefs
View(boot_coefs)
boot_coefs %>%
mutate(sig = ifelse(term %in% sig, "TRUE", "FALSE")) %>%
filter(term %in% c("Health", "Petrol_Diesel","Repair", "School", "Train_Station", "Without_Car", "Work_Bus", "Work_Train"))
boot_coefs <- boot_models %>%
unnest(coef_info)
boot_coefs <-  boot_coefs %>%
mutate(sig = ifelse(term %in% sig, "TRUE", "FALSE")) %>%
filter(term %in% c("Health", "Petrol_Diesel","Repair", "School", "Train_Station", "Without_Car", "Work_Bus", "Work_Train"))
boot_coefs2 <- boot_coefs %>%
group_by(term) %>%
summarise(est = median(estimate), lower = quantile(estimate, 0.025), upper = quantile(estimate, 0.975))
boot_coefs <-
ggplot() +
geom_density(aes(estimate, fill = sig), alpha = 0.7,  color = "white") +
geom_vline(data = boot_coefs2, mapping = aes(xintercept = est))+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = lower), color="Red", lty = 2)+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = upper), color="Red", lty = 2)+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = 0), color="Blue", lty = 2)+
facet_wrap(~term, scales = "free")
boot_coefs <- boot_models %>%
unnest(coef_info)
boot_coefs <-  boot_coefs %>%
mutate(sig = ifelse(term %in% sig, "TRUE", "FALSE")) %>%
filter(term %in% c("Health", "Petrol_Diesel","Repair", "School", "Train_Station", "Without_Car", "Work_Bus", "Work_Train"))
boot_coefs2 <- boot_coefs %>%
group_by(term) %>%
summarise(est = median(estimate), lower = quantile(estimate, 0.025), upper = quantile(estimate, 0.975))
boot_coefs %>%
ggplot() +
geom_density(aes(estimate, fill = sig), alpha = 0.7,  color = "white") +
geom_vline(data = boot_coefs2, mapping = aes(xintercept = est))+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = lower), color="Red", lty = 2)+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = upper), color="Red", lty = 2)+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = 0), color="Blue", lty = 2)+
facet_wrap(~term, scales = "free")
boot_coefs2
sig
boot_coefs <- boot_models %>%
unnest(coef_info)
boot_coefs %>%
group_by(term)
boot_coefs %>%
group_by(term) %>%
summarise(est = median(estimate), lower = quantile(estimate, 0.025), upper = quantile(estimate, 0.975))
boot_coefs <- boot_models %>%
unnest(coef_info)
boot_coefs <-  boot_coefs %>%
mutate(sig = ifelse(term %in% sig, "TRUE", "FALSE")) %>%
filter(term %in% c("Health", "Petrol_Diesel","Repair", "School", "Train_Stations", "Without_Car", "Work_Bus", "Work_Train"))
boot_coefs2 <- boot_coefs %>%
group_by(term) %>%
summarise(est = median(estimate), lower = quantile(estimate, 0.025), upper = quantile(estimate, 0.975))
boot_coefs %>%
ggplot() +
geom_density(aes(estimate, fill = sig), alpha = 0.7,  color = "white") +
geom_vline(data = boot_coefs2, mapping = aes(xintercept = est))+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = lower), color="Red", lty = 2)+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = upper), color="Red", lty = 2)+
geom_vline(data = boot_coefs2, mapping = aes(xintercept = 0), color="Blue", lty = 2)+
facet_wrap(~term, scales = "free")
